import{r as p,M as P,X as S,f as B,j as E,e as c,o as u,g as l,E as o,u as e,N as I,s as j,a as i,z as n,A as v,V as D,Y as F,F as H,c as x,G as L}from"./app-GeWjX9nR.js";import{_ as d,a as V}from"./Label.vue_vue_type_script_setup_true_lang-qpYNPFTs.js";import{Q as N}from"./vue-quill.esm-bundler-CJM1gjg1.js";import{_ as Z}from"./index-BZs4ypES.js";import{_ as m}from"./InputError.vue_vue_type_script_setup_true_lang-CSC3p7U_.js";import{_ as O,a as k,b as Q,c as R,d as z,e as $,f as A,t as G}from"./useTranslation-DHTSnvpc.js";import{a as X}from"./Index.vue_vue_type_script_setup_true_lang-DJiB7Hbc.js";import{m as Y}from"./useUrl-CBgCp5WS.js";import{m as J,s as h}from"./useSlug-tpINBdFG.js";import{_ as K}from"./InlineHeader.vue_vue_type_script_setup_true_lang-CnMW6Ff2.js";import{w as W}from"./index-H4X_E94e.js";import"./useForwardExpose-Czjpx7C4.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-xDWaSK0z.js";import"./useForwardPropsEmits-CwhGNt__.js";import"./DialogTitle-BMQK83J-.js";import"./createLucideIcon-BoJrWEEx.js";import"./Presence-BrU0gijE.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-BvK7UPRa.js";import"./useFormControl-D4hcQnL-.js";import"./PopperContent-5gib9GK6.js";import"./TextLink.vue_vue_type_script_setup_true_lang-T1_wBD9f.js";import"./Heading.vue_vue_type_script_setup_true_lang-pWtCqrca.js";const ee={class:"w-full mx-auto p-6 rounded-md shadow-sm"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},se={class:"md:col-span-2 space-y-4"},le={class:"space-y-2"},ae={class:"text-sm text-muted-foreground mt-1"},oe={class:"font-mono"},re={class:"text-xs text-muted-foreground mt-1"},ie={class:"w-full"},ne={class:"mt-1 w-full min-h-64 border border-dashed rounded flex items-center justify-center"},de={class:"flex items-center justify-between"},ue={key:0},me={key:1},pe={breadcrumbs:[{title:"Posts",href:route("posts.index")},{title:"Create Post",href:route("posts.create")}]},je=Object.assign(pe,{inheritAttrs:!1},{__name:"Create",props:["canCreatePost"],setup(y){const f=p(!1),g=p(!1),_=p(null),U=P({container:[["bold","italic","underline","strike"],["blockquote","code-block"],["link","video"],["imageUploader"],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}]],handlers:{imageUploader:()=>f.value=!0}}),b=p(null),s=S({title:"",slug:"",meta_description:"",content:"",status:"draft",featured_image:null,categories:[]});function C(){g.value=!0,s.slug=h(s.slug)}const M=B(()=>J(s.slug));function T(){s.post(route("posts.store"),{onBefore:r=>{r.data.featured_image&&(r.data.featured_image=r.data.featured_image.id)},onSuccess:()=>{g.value=!1}})}function q(r){if(!r?.path)return;_.value=r;const a=`<img src="${Y(r.path)}" alt="${r.alt}" title="${r.title}">`,w=b.value.getQuill();w.pasteHTML(w.getSelection().index,a),_.value=null}return W(()=>s.title,async r=>{let t=await G(r);t=t?.translated;const a=h(t||r);g.value||(s.slug=a)},{debounce:100}),E(()=>{let r=document.querySelector(".ql-imageUploader");r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#646c72"><path d="M480-480ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h320v80H200v560h560v-280h80v280q0 33-23.5 56.5T760-120H200Zm40-160h480L570-480 450-320l-90-120-120 160Zm480-280v-167l-64 63-56-56 160-160 160 160-56 56-64-63v167h-80Z"/></svg>'}),(r,t)=>(u(),c(L,null,[l(e(I),{title:"Create Post"}),o("div",ee,[l(K,{title:"Create Posts",link:{href:r.route("posts.index"),text:"Back to posts"}},null,8,["link"]),o("form",{onSubmit:j(T,["prevent"]),class:"space-y-4"},[o("div",te,[o("div",se,[o("div",le,[l(e(d),{for:"title"},{default:i(()=>t[9]||(t[9]=[n("Title",-1)])),_:1,__:[9]}),l(e(V),{id:"title",modelValue:e(s).title,"onUpdate:modelValue":t[0]||(t[0]=a=>e(s).title=a),placeholder:"Post title",required:""},null,8,["modelValue"]),l(m,{message:e(s).errors.title},null,8,["message"])]),o("div",null,[l(e(d),{for:"slug"},{default:i(()=>t[10]||(t[10]=[n("Slug",-1)])),_:1,__:[10]}),l(e(V),{id:"slug",modelValue:e(s).slug,"onUpdate:modelValue":t[1]||(t[1]=a=>e(s).slug=a),onInput:C,placeholder:"post-slug",required:""},null,8,["modelValue"]),o("p",ae,[t[11]||(t[11]=n("URL preview: ",-1)),o("span",oe,v(M.value),1)]),l(m,{message:e(s).errors.slug},null,8,["message"])]),o("div",null,[l(e(d),{for:"meta_description"},{default:i(()=>t[12]||(t[12]=[n("Meta description",-1)])),_:1,__:[12]}),D(o("textarea",{id:"meta_description","onUpdate:modelValue":t[2]||(t[2]=a=>e(s).meta_description=a),class:H(["w-full rounded outline-0 p-2 mt-1 bg-transparent border",{"border-destructive":(e(s).meta_description||"").length>200}]),rows:"3",placeholder:"Meta description for SEO (max ~160 chars)"},null,2),[[F,e(s).meta_description]]),o("p",re,v((e(s).meta_description||"").length)+" / 200",1),l(m,{message:e(s).errors.meta_description},null,8,["message"])]),o("div",ie,[l(e(d),{for:"categories"},{default:i(()=>t[13]||(t[13]=[n("Categories",-1)])),_:1,__:[13]}),l(O,{modelValue:e(s).categories,"onUpdate:modelValue":t[3]||(t[3]=a=>e(s).categories=a)},null,8,["modelValue"])])]),o("div",null,[l(e(d),{for:"meta_description"},{default:i(()=>t[14]||(t[14]=[n("Featured Image",-1)])),_:1,__:[14]}),o("div",ne,[e(s).featured_image?(u(),x(X,{key:0,item:e(s).featured_image,select:!1,class:"w-full [&>img]:h-auto",onRemoved:t[4]||(t[4]=a=>e(s).featured_image=null)},null,8,["item"])):(u(),x(k,{key:1,modelValue:e(s).featured_image,"onUpdate:modelValue":t[5]||(t[5]=a=>e(s).featured_image=a)},null,8,["modelValue"]))]),l(m,{message:e(s).errors.meta_description},null,8,["message"])])]),o("div",null,[l(e(d),{for:"content",class:"mb-2"},{default:i(()=>t[15]||(t[15]=[n("Content",-1)])),_:1,__:[15]}),l(k,{"model-value":_.value,"onUpdate:modelValue":q,open:f.value,"onUpdate:open":t[6]||(t[6]=a=>f.value=a)},{trigger:i(()=>t[16]||(t[16]=[o("span",null,null,-1)])),_:1},8,["model-value","open"]),l(e(N),{content:e(s).content,"onUpdate:content":t[7]||(t[7]=a=>e(s).content=a),ref_key:"editor",ref:b,"content-type":"html",placeholder:"Post content",toolbar:U,theme:"snow"},null,8,["content","toolbar"]),l(m,{message:e(s).errors.content},null,8,["message"])]),o("div",de,[l(e(A),{modelValue:e(s).status,"onUpdate:modelValue":t[8]||(t[8]=a=>e(s).status=a),id:"status",name:"status",required:"","default-value":"draft"},{default:i(()=>[l(e(Q),{class:"w-[180px]"},{default:i(()=>[l(e(R),{placeholder:"Status"})]),_:1}),l(e(z),null,{default:i(()=>[l(e($),{value:"draft"},{default:i(()=>t[17]||(t[17]=[n("Draft",-1)])),_:1,__:[17]}),l(e($),{value:"published"},{default:i(()=>[n(v(`${y.canCreatePost?"":"Request To "}Publish`),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(e(Z),{type:"submit",disabled:e(s).processing},{default:i(()=>[e(s).processing?(u(),c("span",ue,"Creating...")):(u(),c("span",me,"Create post"))]),_:1},8,["disabled"])])],32)])],64))}});export{je as default};
